<script
  src="https://code.jquery.com/jquery-3.6.3.min.js"
  integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU="
  crossorigin="anonymous"
></script>
<script src="https://kenwheeler.github.io/slick/slick/slick.js"></script>

<nav
  class="navbar navbar-light navbar-vertical navbar-expand-xl navbar-top-combo"
  style="height: 6rem"
>
  <div
    class="d-flex align-items-center"
    style="background-color: #edf2f9; height: 5.3rem; width: 13.5rem"
  >
    <a class="navbar-brand" href="#">
      <div class="d-flex align-items-center py-2">
        <img
          class="ml-3 mt-3"
          src="/img/FrontShare Logo.png"
          alt=""
          width="150px"
        />
      </div>
    </a>
  </div>
</nav>
<nav
  class="navbar navbar-expand-lg navbar-light navbar-glass sticky-kit navbar-top navbar-top-combo"
  data-move-target="#yourUniqueID"
  style="padding: unset !important; margin-top: 6rem"
>
  <!-- Your navbar top content here-->
  <nav
    class="navbar navbar-expand-lg navbar-light"
    style="
      width: 86%;
      margin-left: 13.5rem;
      position: fixed;
      top: 0;
      background-color: #edf2f9;
    "
  >
    <div class="search-box">
      <form
        class="position-relative show"
        data-bs-toggle="search"
        data-bs-display="static"
        aria-expanded="true"
      >
        <input
          class="form-control search-input fuzzy-search"
          type="search"
          placeholder="Search..."
          aria-label="Search"
        />
      </form>
    </div>
    <div class="d-flex" style="width: 95%; margin: 1rem auto">
      <div class="input-group" style="width: 55%; margin: 0 1rem">
        <input
          class="form-control rounded-pill"
          type="text"
          aria-label="Text input with button"
          id="myInput-1"
          value="localhost:4000/<%=user.profilelink%>"
        />
        <div class="input-group-append">
          <button
            class="btn btn-primary shadow-none rounded-pill"
            type="button"
            onclick="myFunction()"
          >
            Copy
          </button>
          <button
            class="btn btn-primary shadow-none rounded-pill"
            style="border-left: 1px solid black"
            type="button"
            id="updateLinkButton"
          >
            Save
          </button>
        </div>
      </div>
      <div class="input-group" style="width: 30%; margin: 0 1rem">
        <!-- <input
                  class="form-control"
                  type="text"
                  aria-label="Text input with button"
                /> -->
        <!-- <div class="input-group-append">
                  <button class="btn btn-primary shadow-none" type="button">
                    QR
                  </button>
                </div> -->
        <div class="cover">
          <div class="contents">
            <h1>QR</h1>
            <input
              type="text"
              spellcheck="false"
              id="text"
              value="http://localhost:4000/<%=user.profilelink%>"
              style="display: none; visibility: hidden"
            />
            <div id="qrcode"></div>
            <span class="close">Close</span>
          </div>
        </div>
        <button class="btn btn-primary generate-qr rounded-pill">
          Generate QR
        </button>
      </div>
      <a
        href="http://localhost:4000/<%=user.profilelink%>"
        style="width: 15%; margin: 0 1rem"
      >
        <button class="btn btn-secondary shadow-5 rounded-pill" type="button">
          Preview
        </button>
      </a>
    </div>
  </nav>
</nav>

<script src="/js/qr.min.js"></script>
<script>
  $(function () {
    $(".generate-qr").click(function () {
      console.log("hiiiii");
      $(".cover").fadeIn("300");
    });
    $(".cover,.close").click(function () {
      $(".cover").fadeOut("300");
    });
    $(".contents").click(function (e) {
      e.stopPropagation();
    });
  });
</script>
<script>
  const qrcode = document.getElementById("qrcode");
  const textInput = document.getElementById("text");

  const qr = new QRCode(qrcode);

  textInput.oninput = (e) => {
    qr.makeCode(e.target.value.trim());
  };

  qr.makeCode(textInput.value.trim());
</script>
<script>
  function myFunction() {
    // Get the text field
    var copyText = document.getElementById("myInput-1");
    console.log("copy");
    // Select the text field
    copyText.select();
    copyText.setSelectionRange(0, 99999); // For mobile devices

    navigator.clipboard.writeText(copyText.value);
  }
</script>
<script>
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();

      reader.onload = function (e) {
        $("#userImage").attr("src", e.target.result);
      };

      reader.readAsDataURL(input.files[0]);
    }
  }
</script>
<script>
  const passValueUpdateLink = async (profilelink) => {
    try {
      const result = await axios({
        method: "PATCH",
        url: "/api/v1/users/updatelink",
        data: {
          profilelink,
        },
      });
      if (result.data.status === "success") {
        window.alert("YES");
      }
    } catch (err) {
      window.alert("NO");
    }
  };
  const updateLinkButton = document.querySelector("#updateLinkButton");
  updateLinkButton.addEventListener("click", (e) => {
    e.preventDefault();

    const profilelink = document
      .getElementById("myInput-1")
      .value.split("/")[1];
    console.log(profilelink);
    passValueUpdateLink(profilelink);
  });
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>
<!-- <script src="js/profile.js"></script> -->
<script src="assets/js/jquery.min.js"></script>
